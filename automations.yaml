- id: away_evening_start
  alias: Away Evening Start
  trigger:
    platform: sun
    event: sunset
    offset: +00:05:00
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: group.someone_home
      state: 'off'
    - condition: time
      before: '21:00:00'
  action:
  - service: script.select_lights_away
  - service: automation.turn_on
    entity_id: automation.away_evening_end
  - service: script.notify_admin
    data:
      message: Afwezigheidsmodus geactiveerd
- id: away_evening_end
  alias: Away Evening End
  initial_state: 'off'
  trigger:
    platform: time
    at: '23:00:00'
  action:
  - service: script.select_lights_all_off
  - service: automation.turn_on
    entity_id: automation.away_morning_start
  - service: automation.turn_off
    entity_id: automation.away_evening_end
- id: away_morning_start
  alias: Away Morning Start
  initial_state: 'off'
  trigger:
    platform: sun
    event: sunrise
    offset: -01:00:00
  action:
  - service: script.select_lights_away
  - service: automation.turn_on
    entity_id: automation.away_morning_end
  - service: automation.turn_off
    entity_id: automation.away_morning_start
- id: away_morning_end
  alias: Away Morning End
  initial_state: 'off'
  trigger:
    platform: sun
    event: sunrise
  action:
  - service: script.select_lights_all_off
  - service: automation.turn_off
    entity_id: automation.away_morning_end
- id: away_cancel
  alias: Away Cancel
  trigger:
    platform: state
    entity_id: group.someone_home
    from: 'off'
    to: 'on'
  condition:
    condition: state
    entity_id: group.away
    state: 'on'
  action:
  - service: homeassistant.turn_off
    entity_id: group.away
- id: midnight_buitenlamp_voor
  alias: Midnight buitenlamp voor
  trigger:
    platform: time
    at: '23:05:00'
  action:
  - service: switch.turn_off
    entity_id: switch.hal_buitenlamp_voor
  - service: light.turn_off
    entity_id: light.kerstverlichting_buiten
  - service: light.turn_off
    entity_id: light.kerstverlichting_voor
  - service: input_boolean.turn_off
    entity_id: input_boolean.evening_trigger_upstairs
- id: sunset_preparation
  alias: Sunset Preparation
  trigger:
    platform: sun
    event: sunset
    offset: -01:00:00
  action:
  - service: input_boolean.turn_on
    entity_id: input_boolean.evening_trigger_upstairs
- id: sunset_phase_1
  alias: Sunset Phase 1
  trigger:
    platform: sun
    event: sunset
    offset: -00:45:00
  condition:
    condition: state
    entity_id: group.activity_at_home
    state: 'on'
  action:
  - service: script.living_scene_regular_phase_1
- id: sunset_phase_2
  alias: Sunset Phase 2
  trigger:
    platform: sun
    event: sunset
    offset: -00:25:00
  condition:
    condition: state
    entity_id: group.activity_at_home
    state: 'on'
  action:
  - service: script.living_scene_regular_phase_2
- id: sunset_phase_3
  alias: Sunset Phase 3
  trigger:
    platform: sun
    event: sunset
    offset: -00:20:00
  condition:
    condition: state
    entity_id: group.activity_at_home
    state: 'on'
  action:
  - service: script.living_scene_regular_phase_3
- id: sunset_phase_4
  alias: Sunset Phase 4
  trigger:
    platform: sun
    event: sunset
    offset: -00:15:00
  condition:
    condition: state
    entity_id: group.activity_at_home
    state: 'on'
  action:
  - service: script.living_scene_regular_phase_4
- id: sunset_phase_5
  alias: Sunset Phase 5
  trigger:
    platform: sun
    event: sunset
    offset: -00:05:00
  condition:
    condition: state
    entity_id: group.activity_at_home
    state: 'on'
  action:
  - service: script.select_lights_regular
- id: sunset_veranda_verlichting
  alias: Sunset veranda verlichting
  trigger:
    platform: sun
    event: sunset
    offset: +00:05:00
  condition:
    condition: state
    entity_id: group.activity_at_home
    state: 'on'
  action:
  - service: light.turn_on
    entity_id: light.kerstverlichting_buiten
- id: sunset_buitenlamp_voor
  alias: Sunset buitenlamp voor
  trigger:
    platform: sun
    event: sunset
    offset: +00:05:00
  action:
  - service: switch.turn_on
    entity_id: switch.hal_buitenlamp_voor
  - service: light.turn_on
    entity_id: light.kerstverlichting_voor
- id: slaapkamer_tv
  alias: Slaapkamer TV
  trigger:
  - platform: state
    entity_id: switch.slaapkamer_tv
  action:
  - service_template: "{% if trigger.to_state.state == 'on' %}\n  script.turn_on\n{%
      else %}\n  light.turn_off\n{% endif %}\n"
    data_template:
      entity_id: "{% if trigger.to_state.state == 'on' %}\n  script.tv_slaapkamer_aan\n{%
        else %}\n  light.slaapkamer_achterwand\n{% endif %}\n"
- id: slaapkamer_achterwand_on
  alias: Slaapkamer Achterwand On
  trigger:
  - platform: state
    entity_id: light.slaapkamer_achterwand
    from: 'off'
    to: 'on'
  action:
  - service_template: timer.cancel
    entity_id: timer.tv_slaapkamer
- id: slaapkamer_achterwand_off
  alias: Slaapkamer Achterwand Off
  description: ''
  triggers:
  - entity_id: light.slaapkamer_achterwand
    from: 'on'
    to: 'off'
    trigger: state
  actions:
  - entity_id: timer.timeout_activity_upstairs
    action: timer.cancel
  - condition: state
    entity_id: switch.slaapkamer_tv
    state: 'on'
  - service_template: timer.start
    entity_id: timer.tv_slaapkamer
- id: timer_tv_slaapkamer
  alias: Timer TV Slaapkamer
  trigger:
  - platform: event
    event_type: timer.finished
    event_data:
      entity_id: timer.tv_slaapkamer
  action:
  - service: script.turn_off_tv_slaapkamer
- id: '1601834029668'
  alias: Turn off kodi slaapkamer
  description: ''
  trigger:
  - platform: device
    device_id: 60e236123004f25f46606590707c3ff2
    domain: kodi
    entity_id: media_player.slaapkamer
    type: turn_off
  condition: []
  action:
  - service: kodi.call_method
    data:
      method: System.Shutdown
      entity_id: media_player.slaapkamer
    entity_id: media_player.slaapkamer
  mode: single
- id: light_scene_select
  alias: Light Scene Select
  trigger:
    platform: state
    entity_id: input_select.light_scene
  action:
  - service: script.turn_on
    data_template:
      entity_id: "{% set scene = trigger.to_state.state %} {% if scene == 'Afwezig'
        %}\n  script.living_scene_away\n{% elif scene == 'Normaal' %}\n  script.living_scene_regular\n{%
        elif scene == 'Zacht' %}\n  script.living_scene_dim\n{% elif scene == 'Erg
        Zacht' %}\n  script.living_scene_very_dim\n{% elif scene == 'Maximaal' %}\n
        \ script.living_scene_maximal\n{% else %}\n  script.living_scene_all_off\n{%
        endif %}\n"
- id: scene_select
  alias: Scene Select
  triggers:
  - entity_id: input_select.media_scene
    trigger: state
  actions:
  - data_template:
      entity_id: "{% set scene = trigger.to_state.state %} {% if scene == 'Radio luisteren'
        %}\n  script.listen_radio\n{% elif scene == 'TV kijken' %}\n  script.watch_tv\n{%
        elif scene == 'Media kijken' %}\n  script.watch_media\n{% else %}\n  script.all_media_off\n{%
        endif %}\n"
    action: script.turn_on
- id: toggle_living
  alias: Toggle Living
  triggers:
  - event_type: zwave_js_value_notification
    event_data:
      node_id: 16
      command_class_name: Scene Activation
    trigger: event
  conditions:
  - condition: template
    value_template: '{{ (trigger.event.data.value // 10) == 2 }}'
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: group.living_room_lights
        state: 'on'
      sequence:
      - action: script.all_off
        data: {}
    - conditions:
      - condition: time
        before: '12:00:00'
      sequence:
      - action: script.select_lights_away
        data: {}
      - action: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.verlichting_keuken
    default:
    - action: script.select_lights_regular
      data: {}
- id: '1601907810392'
  alias: Turn off kodi woonkamer
  description: ''
  trigger:
  - platform: device
    device_id: 4e4baa235c6fc91749ada1e24683d001
    domain: kodi
    entity_id: cc87eec8286d5eedcdb0afdb5efb954d
    type: turn_off
  condition: []
  action:
  - service: kodi.call_method
    data:
      method: System.Shutdown
      entity_id: media_player.woonkamer
  mode: single
- id: select_logger_level_default
  alias: Select Default Logger Level
  trigger:
    platform: state
    entity_id: input_select.logger_level_default
  action:
  - service: logger.set_default_level
    data_template:
      level: '{{ trigger.to_state.state }}'
- id: select_logger_level_homeassistant
  alias: Select Logger Level Home Assistant
  trigger:
    platform: state
    entity_id: input_select.logger_level_homeassistant
  action:
  - service: logger.set_level
    data_template:
      homeassistant: '{{ trigger.to_state.state }}'
- id: select_logger_level_zwave
  alias: Select Logger Level Z-Wave
  trigger:
    platform: state
    entity_id: input_select.logger_level_zwave
  action:
  - service: logger.set_level
    data_template:
      homeassistant.components.zwave: '{{ trigger.to_state.state }}'
  - service: logger.set_level
    data_template:
      openzwave: '{{ trigger.to_state.state }}'
  - service: logger.set_level
    data_template:
      libopenzwave: '{{ trigger.to_state.state }}'
- id: select_logger_level_zigbee
  alias: Select Logger Level Zigbee
  trigger:
    platform: state
    entity_id: input_select.logger_level_zigbee
  action:
  - service: logger.set_level
    data_template:
      homeassistant.components.zha: '{{ trigger.to_state.state }}'
  - service: logger.set_level
    data_template:
      zigpy_deconz: '{{ trigger.to_state.state }}'
  - service: logger.set_level
    data_template:
      zigpy.zcl: '{{ trigger.to_state.state }}'
- id: select_logger_level_esphome
  alias: Select Logger Level ESPHome
  trigger:
    platform: state
    entity_id: input_select.logger_level_esphome
  action:
  - service: logger.set_level
    data_template:
      aioesphomeapi: '{{ trigger.to_state.state }}'
- id: notify_warm_outside
  alias: Notificatie Warm Buiten
  trigger:
  - platform: numeric_state
    entity_id: sensor.temperatuurverschil_buiten_binnen
    above: 0
  action:
  - service: script.notify_admin
    data:
      message: Het is buiten warmer dan binnen
  - service: automation.turn_on
    entity_id: automation.notificatie_koud_buiten
  - service: automation.turn_off
    entity_id: automation.notificatie_warm_buiten
- id: notify_cold_outside
  alias: Notificatie Koud Buiten
  trigger:
  - platform: numeric_state
    entity_id: sensor.temperatuurverschil_buiten_binnen
    below: 0
  action:
  - service: script.notify_admin
    data:
      message: Het is buiten kouder dan binnen
  - service: automation.turn_on
    entity_id: automation.notificatie_warm_buiten
  - service: automation.turn_off
    entity_id: automation.notificatie_koud_buiten
- id: rf_button_tv_slaapkamer
  alias: RF Button TV Slaapkamer
  trigger:
  - platform: state
    entity_id: binary_sensor.rf_button_tv_slaapkamer
    from: 'off'
    to: 'on'
  action:
  - service: script.toggle_tv_slaapkamer
- id: rf_button_watch_tv
  alias: RF Button Watch TV
  trigger:
  - platform: state
    entity_id: binary_sensor.rf_button_watch_tv
    from: 'off'
    to: 'on'
  action:
  - service: script.select_tv_kijken
- id: rf_button_watch_media
  alias: RF Button Watch Media
  trigger:
  - platform: state
    entity_id: binary_sensor.rf_button_watch_media
    from: 'off'
    to: 'on'
  action:
  - service: script.select_media_kijken
- id: rf_button_listen_music
  alias: RF Button Listen Music
  trigger:
  - platform: state
    entity_id: binary_sensor.rf_button_listen_music
    from: 'off'
    to: 'on'
  action:
  - service: script.select_radio_luisteren
- id: rf_button_all_off
  alias: RF Button All Off
  trigger:
  - platform: state
    entity_id: binary_sensor.rf_button_all_off
    from: 'off'
    to: 'on'
  action:
  - service: script.all_off
- id: alert_coolmonoxide
  alias: Waarschuwing Rook en/of Koolmonoxide
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.koolmonoxidemelder_carbon_monoxide_detected
    - binary_sensor.rookmelder_hal_smoke_detected
    - binary_sensor.rookmelder_woonkamer_smoke_detected
    - binary_sensor.rookmelder_zolder_smoke_detected
    - binary_sensor.rookmelder_overloop_smoke_detected
    to: 'on'
  action:
  - service: script.notify_alert
    data:
      message: '{{ trigger.to_state.name }}'
- id: test_coolmonoxide
  alias: Test Rook en/of Koolmonoxide
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.koolmonoxidemelder_carbon_monoxide_test
    - binary_sensor.rookmelder_hal_smoke_alarm_test
    - binary_sensor.rookmelder_zolder_smoke_alarm_test
    - binary_sensor.rookmelder_overloop_smoke_alarm_test
    - binary_sensor.rookmelder_woonkamer_smoke_alarm_test
    from: 'off'
    to: 'on'
  action:
  - service: script.notify_admin
    data:
      message: '{{ trigger.to_state.name }}'
- id: startup
  alias: Opstarten
  triggers:
  - event: start
    trigger: homeassistant
  actions:
  - action: automation.trigger
    metadata: {}
    data:
      skip_condition: true
    target:
      entity_id: automation.sync_scene_select
  - action: script.detect_lights
    data: {}
  - entity_id: input_boolean.evening_trigger_upstairs
    action: input_boolean.turn_off
  - condition: sun
    after: sunset
    after_offset: '-1:00:00'
  - condition: time
    before: '23:05:00'
  - entity_id: automation.sunset_preparation
    action: automation.trigger
  initial_state: 'on'
- id: timer_activity_upstairs_cancelled
  alias: Timeout Activiteit boven
  trigger:
  - platform: event
    event_type: timer.cancelled
    event_data:
      entity_id: timer.timeout_activity_upstairs
  action:
  - service: script.notify_admin
    data:
      message: Timer Activiteit Boven Cancelled
- id: reset_activity_upstairs
  alias: Reset Activiteit boven
  trigger:
  - platform: event
    event_type: timer.completed
    event_data:
      entity_id: timer.timeout_activity_upstairs
  action:
  - service: script.notify_admin
    data:
      message: Reset Timer Activiteit Boven
- id: start_activity_upstairs
  alias: Start Timer Activiteit boven
  trigger:
  - platform: event
    event_type: timer.started
    event_data:
      entity_id: timer.timeout_activity_upstairs
  action:
  - service: script.notify_admin
    data:
      message: Started Timer Activiteit Boven
- id: rc_buttons
  alias: RC Buttons
  trigger:
    platform: event
    event_type: zwave_js_value_notification
    event_data:
      node_id: 9
      command_class_name: Scene Activation
  condition:
    condition: template
    value_template: '{{ (trigger.event.data.value % 10) <= 5 }}'
  action:
  - service: script.turn_on
    data_template:
      entity_id: "{% set row = trigger.event.data.value // 10 %} {% set side = (trigger.event.data.value
        % 10) % 2 %} {% if row == 1 %}\n  script.spruitje_{% if side == 1 %}on{% else
        %}off{% endif %}\n{% elif row == 6 %}\n  script.kerstboom_{% if side == 1
        %}on{% else %}off{% endif %}\n{% elif row == 7 %}\n  script.veranda_lights_{%
        if side == 1 %}on{% else %}off{% endif %}\n{% elif row >= 8 and row <= 10
        %}\n  {% if side == 1 %}\n    {% if row == 8 %}\n      script.select_tv_kijken\n
        \   {% elif row == 9 %}\n      script.select_media_kijken\n    {% else %}\n
        \     script.select_radio_luisteren\n    {% endif %}\n  {% else %}\n    script.select_geen\n
        \ {% endif %}\n{% elif row == 11 %}\n  {% if side == 1 %}\n    script.select_lights_maximal\n
        \ {% else %}\n    script.all_off\n  {% endif %}\n{% elif side == 1 and row
        == 2 %}\n  script.select_lights_regular\n{% elif side == 1 and row == 3 %}\n
        \ script.select_lights_dim\n{% elif side == 1 and row == 4 %}\n  script.select_lights_very_dim\n{%
        elif side == 1 and row == 5 %}\n  script.select_lights_away\n{% else %}\n
        \ script.select_lights_all_off\n{% endif %}\n"
- id: lamp_overloop_off
  alias: Lamp Overloop Off
  trigger:
  - platform: state
    entity_id: switch.overloop_lamp
    from: 'on'
    to: 'off'
  action:
  - service: timer.cancel
    entity_id: timer.timeout_activity_upstairs
- id: timeout_activity_upstairs
  alias: Timeout Activiteit boven
  trigger:
  - platform: event
    event_type: timer.finished
    event_data:
      entity_id: timer.timeout_activity_upstairs
  action:
  - service: light.turn_off
    entity_id: light.slaapkamer_achterwand
  - service: switch.turn_off
    entity_id: switch.overloop_lamp
  - service: input_boolean.turn_on
    entity_id: input_boolean.evening_trigger_upstairs
  - service: script.notify_admin
    data:
      message: Timeout Activiteit Boven
- id: '1668960889704'
  alias: RF Kantoor Lights turn on
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.rf_button_office_lights
    to: 'on'
  condition:
  - condition: state
    entity_id: light.kantoor
    state: 'off'
  action:
  - service: light.turn_on
    data: {}
    target:
      entity_id: light.kantoor
  mode: single
- id: '1668968231502'
  alias: Kantoor Alex Auto turn off
  description: ''
  trigger:
  - platform: numeric_state
    entity_id:
    - sensor.kantoor_alex_power_mean_5min
    for:
      hours: 0
      minutes: 10
      seconds: 0
    below: 18
  condition:
  - condition: state
    entity_id: switch.kantoor_alex
    state: 'on'
  action:
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.kantoor_alex
  mode: single
- id: '1668968557946'
  alias: Kantoor Joyce Auto turn off
  description: ''
  trigger:
  - platform: numeric_state
    entity_id:
    - sensor.kantoor_joyce_power_mean_5min
    for:
      hours: 0
      minutes: 10
      seconds: 0
    below: 10
  condition:
  - condition: state
    entity_id: switch.kantoor_joyce
    state: 'on'
  action:
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.kantoor_joyce
  mode: single
- id: '1668969907904'
  alias: RF Kantoor Lights turn off
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.rf_button_office_lights
    to: 'on'
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: light.kantoor
      state: 'on'
    - condition: state
      entity_id: switch.kantoor_alex
      state: 'on'
  action:
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.kantoor
  mode: single
- id: '1691308597750'
  alias: Walli Toggle
  description: ''
  trigger:
  - platform: event
    event_type: zwave_js_value_notification
    event_data:
      command_class: 91
      value: KeyPressed
    variables:
      intent: '{{ ''on'' if trigger.event.data.property_key == ''001'' else ''off''
        }}'
      entity: '{{ device_entities(trigger.event.data.device_id) | select(''is_state_attr'',
        ''supported_features'', 32) | first }}'
      do_toggle: '{{ is_state(entity, intent) }}'
  condition:
  - condition: template
    value_template: '{{ do_toggle }}'
    enabled: true
  action:
  - service: light.toggle
    data: {}
    target:
      entity_id: '{{ entity }}'
  mode: single
- id: '1691314108806'
  alias: Walli Refresh
  description: ''
  trigger:
  - platform: time_pattern
    minutes: /10
  condition: []
  action:
  - service: zwave_js.refresh_value
    data:
      refresh_all_values: false
      entity_id:
      - light.licht_kledingkamer
      - light.licht_slaapkamer
      - light.toilet
      - light.licht_studiekamer
      - light.licht_badkamer
      - light.buitenverlichting_achter
  mode: single
- id: '1691833100779'
  alias: Badkamer Wastafel follows main
  description: ''
  trigger:
  - platform: state
    entity_id:
    - light.licht_badkamer
  condition: []
  action:
  - delay:
      hours: 0
      minutes: 0
      seconds: 1
      milliseconds: 0
  - service: switch.turn_{{ trigger.to_state.state }}
    data:
      entity_id: switch.wastafel_badkamer
  mode: single
- id: '1692126269530'
  alias: Mechanische Ventilatie Auto Off
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.mechanische_ventilatie_power
    above: 15
  condition: []
  action:
  - wait_for_trigger:
    - platform: numeric_state
      entity_id: sensor.mechanische_ventilatie_power
      for:
        hours: 0
        minutes: 30
        seconds: 0
      below: 15
  - service: fan.turn_off
    data: {}
    target:
      entity_id: fan.mechanische_ventilatie
  mode: restart
- id: '1692597555320'
  alias: Sync Buitenverlichting
  description: ''
  trigger:
  - platform: state
    entity_id:
    - light.schakelaars_hal_2
    to: 'on'
  - platform: state
    entity_id:
    - light.schakelaars_hal_2
    to: 'off'
  condition: []
  action:
  - service: light.turn_{{ trigger.to_state.state }}
    data:
      entity_id: light.buitenverlichting_garage
  - service: light.turn_{{ trigger.to_state.state }}
    data:
      entity_id: light.buitenverlichting_achter
  - service: light.turn_{{ trigger.to_state.state }}
    data:
      entity_id: light.kerstverlichting_voor
  mode: single
- id: '1694939067662'
  alias: Remote Kantoor turn mains on
  description: ''
  trigger:
  - platform: event
    event_type: zwave_js_value_notification
    event_data:
      command_class: 91
      value: KeyPressed
      node_id: 63
      property_key: '003'
  condition: []
  action:
  - service: switch.turn_on
    data: {}
    target:
      entity_id: switch.kantoor_alex
  mode: single
- id: '1695009249911'
  alias: Kantoor remote turn on bureaulamp
  description: ''
  trigger:
  - platform: event
    event_type: zwave_js_value_notification
    event_data:
      command_class: 91
      value: KeyPressed
      node_id: 63
      property_key: '004'
  condition: []
  action:
  - service: light.toggle
    data: {}
    target:
      entity_id: light.zolder_bureaulamp
  mode: single
- id: '1702881572111'
  alias: RF Kantoor Mains On
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.rf_button_office_lights
    to: 'on'
    from: 'off'
  condition: []
  action:
  - service: switch.turn_on
    target:
      entity_id: switch.kantoor_alex
    data: {}
  mode: single
- id: '1752905451995'
  alias: Sync Scene Select
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - media_player.receiver
  - trigger: state
    entity_id:
    - media_player.tv
  - trigger: state
    entity_id:
    - switch.tv_meubel_mediaplayer
  conditions:
  - condition: state
    entity_id: binary_sensor.all_media_available
    state: 'on'
  actions:
  - action: automation.turn_off
    metadata: {}
    data:
      stop_actions: false
    target:
      entity_id: automation.scene_select
  - if:
    - condition: state
      entity_id: switch.tv_meubel_mediaplayer
      state: 'on'
    then:
    - action: input_select.select_option
      metadata: {}
      data:
        option: Media kijken
      target:
        entity_id: input_select.media_scene
    else:
    - if:
      - condition: state
        entity_id: media_player.tv
        state: 'on'
      then:
      - action: input_select.select_option
        metadata: {}
        data:
          option: TV kijken
        target:
          entity_id: input_select.media_scene
      else:
      - if:
        - condition: state
          entity_id: media_player.receiver
          state: 'on'
        then:
        - action: input_select.select_option
          metadata: {}
          data:
            option: Radio luisteren
          target:
            entity_id: input_select.media_scene
        else:
        - action: input_select.select_option
          metadata: {}
          data:
            option: Geen
          target:
            entity_id: input_select.media_scene
  - action: automation.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: automation.scene_select
  mode: single
- id: '1753514380407'
  alias: Set TV Operative
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - media_player.receiver
  - trigger: state
    entity_id:
    - media_player.tv
  conditions:
  - condition: template
    value_template: '{{has_value(''media_player.receiver'') and has_value(''media_player.tv'')}}'
  actions:
  - choose:
    - conditions:
      - condition: and
        conditions:
        - condition: state
          entity_id: media_player.tv
          state: 'on'
        - condition: state
          state: 'on'
          entity_id: media_player.receiver
      sequence:
      - delay:
          hours: 0
          minutes: 0
          seconds: 5
          milliseconds: 0
      - action: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.tv_operative
    default:
    - action: input_boolean.turn_off
      metadata: {}
      data: {}
      target:
        entity_id: input_boolean.tv_operative
  mode: restart
- id: '1753601989961'
  alias: Watch Media From Tv
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - media_player.tv
    attribute: source
    to: HDMI 3 (eARC/ARC)
  conditions: []
  actions:
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.watch_media
  mode: single
- id: '1753602369816'
  alias: Watch Tv From Tv
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - media_player.tv
  conditions:
  - condition: template
    value_template: '{{is_state(''media_player.tv'', ''on'') and ''source'' in trigger.from_state.attributes
      and trigger.from_state.attributes[''source''] in (''Kodi'', ''HDMI 3 (eARC/ARC'')
      and not ''source'' in trigger.to_state.attributes}}'
  actions:
  - action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: script.watch_tv
    enabled: true
  mode: single
- id: '1754072343842'
  alias: Pause Mediaplayer when Tv Off
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - media_player.tv
    to: 'off'
  conditions:
  - condition: state
    entity_id: switch.tv_meubel_mediaplayer
    state: 'on'
  actions:
  - action: timer.start
    metadata: {}
    data: {}
    target:
      entity_id: timer.mediaplayer_shutdown
  - action: media_player.media_pause
    metadata: {}
    data: {}
    target:
      entity_id: media_player.woonkamer
  mode: single
- id: '1754072519829'
  alias: Cancel mediaplayer shutdown when Tv on
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - media_player.tv
    from: 'off'
    to: 'on'
  conditions:
  - condition: state
    entity_id: switch.tv_meubel_mediaplayer
    state: 'on'
  actions:
  - action: timer.cancel
    metadata: {}
    data: {}
    target:
      entity_id: timer.mediaplayer_shutdown
  mode: single
- id: '1754072967557'
  alias: Poweroff Mediaplayer when timer fires
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - timer.mediaplayer_shutdown
    from: active
    to: idle
  conditions: []
  actions:
  - action: media_player.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: media_player.woonkamer
  - delay:
      hours: 0
      minutes: 0
      seconds: 10
      milliseconds: 0
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: switch.tv_meubel_mediaplayer
  mode: single
