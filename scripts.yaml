detect_lights:
  alias: Detect light scene based on state
  sequence:
  - wait_template: '{{ is_state(''binary_sensor.tv_meubel_status'', ''on'') }}'
    timeout: 00:00:30
  - delay: 00:00:05
  - condition: state
    entity_id: binary_sensor.tv_meubel_status
    state: 'on'
  - service: script.silent_light_scene_select
living_scene_away:
  sequence:
  - entity_id: scene.living_away
    action: scene.turn_on
living_scene_regular:
  sequence:
  - action: scene.turn_on
    data: {}
    target:
      entity_id: scene.living_regular
living_scene_regular_phase_1:
  sequence:
  - action: script.silent_light_scene_select
    data: {}
living_scene_regular_phase_2:
  sequence:
  - entity_id: scene.living_regular_phase_1
    action: scene.turn_on
  - action: script.silent_light_scene_select
    data: {}
living_scene_regular_phase_3:
  sequence:
  - entity_id: scene.living_regular_phase_2
    action: scene.turn_on
  - action: script.silent_light_scene_select
    data: {}
living_scene_regular_phase_4:
  sequence:
  - entity_id: scene.living_regular_phase_3
    action: scene.turn_on
  - action: script.silent_light_scene_select
    data: {}
living_scene_dim:
  sequence:
  - entity_id: scene.living_dim
    action: scene.turn_on
living_scene_very_dim:
  sequence:
  - entity_id: scene.living_very_dim
    action: scene.turn_on
living_scene_maximal:
  sequence:
  - entity_id: scene.living_max
    action: scene.turn_on
living_scene_all_off:
  sequence:
  - entity_id: scene.living_off
    action: scene.turn_on
silent_light_scene_select:
  alias: Silent Light Scene Select
  sequence:
  - condition: or
    conditions:
    - condition: state
      entity_id: input_select.light_scene
      state: Uit
    - condition: state
      entity_id: light.tv_meubel_spruitje
      state: 'off'
  - delay: 00:00:01
  - service: automation.turn_off
    entity_id: automation.light_scene_select
  - service_template: "{% if is_state('light.tv_meubel_spruitje', 'on') %}\n  script.select_lights_dim\n{%
      elif is_state('light.raam', 'on') %}\n  script.select_lights_away\n{% else %}\n
      \ script.select_lights_all_off\n{% endif %}\n"
  - service: automation.turn_on
    entity_id: automation.light_scene_select
all_lights_off:
  alias: All Lights Off
  sequence:
  - action: script.select_lights_all_off
    data: {}
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id:
      - light.verlichting_keuken
      - light.eettafel
      - light.buitenverlichting_veranda
      - light.kerstverlichting_buiten
      - light.kerstboom
  - action: script.prepare_for_bed
    data: {}
  - condition: sun
    after: sunset
  - entity_id: switch.hal_lamp
    action: switch.turn_on
  - delay: 00:00:55
  - entity_id: switch.hal_lamp
    action: switch.turn_off
select_lights_maximal:
  alias: Select Light Scene Maximal
  sequence:
  - service: input_select.select_option
    data_template:
      entity_id: input_select.light_scene
      option: Maximaal
select_lights_regular:
  alias: Select Light Scene Regular
  sequence:
  - service: input_select.select_option
    data_template:
      entity_id: input_select.light_scene
      option: Normaal
select_lights_dim:
  alias: Select Light Scene Dim
  sequence:
  - service: input_select.select_option
    data_template:
      entity_id: input_select.light_scene
      option: Zacht
select_lights_very_dim:
  alias: Select Light Scene Very Dim
  sequence:
  - service: input_select.select_option
    data_template:
      entity_id: input_select.light_scene
      option: Erg Zacht
select_lights_away:
  alias: Select Light Scene Away
  sequence:
  - service: input_select.select_option
    data_template:
      entity_id: input_select.light_scene
      option: Afwezig
select_lights_all_off:
  alias: Select Light Scene All Off
  sequence:
  - service: input_select.select_option
    data_template:
      entity_id: input_select.light_scene
      option: Uit
kerstboom_on:
  sequence:
  - action: light.turn_on
    target:
      entity_id: light.kerstboom
    data: {}
kerstboom_off:
  sequence:
  - action: light.turn_off
    target:
      entity_id: light.kerstboom
    data: {}
spruitje_on:
  sequence:
  - service: light.turn_on
    entity_id: light.tv_meubel_spruitje
  - service: script.silent_light_scene_select
spruitje_off:
  sequence:
  - service: light.turn_off
    entity_id: light.tv_meubel_spruitje
  - service: script.silent_light_scene_select
veranda_lights_on:
  sequence:
  - service: light.turn_on
    data: {}
    target:
      entity_id:
      - light.buitenverlichting_veranda
veranda_lights_off:
  sequence:
  - service: light.turn_off
    data: {}
    target:
      entity_id:
      - light.buitenverlichting_veranda
select_geen:
  alias: Select media scene Geen
  sequence:
  - service: input_select.select_option
    data:
      entity_id: input_select.media_scene
      option: Geen
select_tv_kijken:
  alias: Select media scene TV kijken
  sequence:
  - service: input_select.select_option
    data:
      entity_id: input_select.media_scene
      option: TV kijken
select_media_kijken:
  alias: Select media scene Media kijken
  sequence:
  - service: input_select.select_option
    data:
      entity_id: input_select.media_scene
      option: Media kijken
select_radio_luisteren:
  alias: Select media scene Radio luisteren
  sequence:
  - service: input_select.select_option
    data:
      entity_id: input_select.media_scene
      option: Radio luisteren
listen_radio:
  alias: Listen Radio
  sequence:
  - action: script.shutdown_tv
    data: {}
  - action: media_player.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: media_player.receiver
watch_tv:
  alias: Watch TV
  sequence:
  - action: script.shutdown_mediaplayer
    data: {}
  - wait_template: '{{ is_state(''switch.tv_meubel_mediaplayer'', ''off'') }}'
    timeout: 00:00:10
  - action: script.powerup_tv
    data: {}
watch_media:
  alias: Watch Media
  sequence:
  - action: script.powerup_mediaplayer
    data: {}
  description: ''
all_media_off:
  alias: All Media Off
  sequence:
  - service: script.shutdown_receiver
all_off:
  alias: All Off
  sequence:
  - service: script.select_geen
  - service: script.all_lights_off
shutdown_mediaplayer:
  alias: Shutdown Mediaplayer
  sequence:
  - condition: state
    entity_id: switch.tv_meubel_mediaplayer
    state: 'on'
  - entity_id: media_player.woonkamer
    action: media_player.turn_off
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - entity_id: switch.tv_meubel_mediaplayer
    action: switch.turn_off
shutdown_tv:
  alias: Shutdown TV
  sequence:
  - condition: state
    state: 'on'
    entity_id: media_player.tv
  - action: script.shutdown_mediaplayer
    data: {}
  - wait_template: '{{ is_state(''switch.tv_meubel_mediaplayer'', ''off'') }}'
    timeout: 00:00:20
  - action: media_player.turn_off
    target:
      entity_id: media_player.tv
    data: {}
shutdown_receiver:
  alias: Shutdown Receiver
  sequence:
  - data: {}
    action: script.shutdown_tv
  - data: {}
    action: media_player.turn_off
    target:
      entity_id: media_player.receiver
powerup_tv:
  alias: Powerup TV
  sequence:
  - action: media_player.turn_on
    target:
      entity_id:
      - media_player.tv
    data: {}
  description: ''
powerup_mediaplayer:
  alias: Powerup Mediaplayer
  sequence:
  - action: script.powerup_tv
    data: {}
  - wait_template: '{{is_state("input_boolean.tv_operative", "on")}}'
    continue_on_timeout: false
    timeout: '30'
  - action: media_player.select_source
    metadata: {}
    data:
      source: Media Player
    target:
      entity_id: media_player.receiver
  - action: switch.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: switch.tv_meubel_mediaplayer
  description: ''
prepare_for_bed:
  alias: Klaarmaken om naar bed te gaan
  sequence:
  - condition: state
    entity_id: input_boolean.evening_trigger_upstairs
    state: 'on'
  - service: input_boolean.turn_off
    entity_id: input_boolean.evening_trigger_upstairs
  - service: switch.turn_on
    entity_id: switch.overloop_lamp
  - service: light.turn_on
    entity_id: light.slaapkamer_achterwand
  - service: timer.start
    entity_id: timer.timeout_activity_upstairs
tv_slaapkamer_aan:
  alias: TV slaapkamer aan
  sequence:
  - service: timer.cancel
    entity_id: timer.timeout_activity_upstairs
  - condition: state
    entity_id: sun.sun
    state: below_horizon
  - service: light.turn_on
    entity_id: light.slaapkamer_achterwand
toggle_tv_slaapkamer:
  alias: Toggle TV Slaapkamer
  sequence:
  - service_template: "{% if is_state('switch.slaapkamer_tv', 'off') %}\n  switch.turn_on\n{%
      else %}\n  script.turn_on\n{% endif %}\n"
    data_template:
      entity_id: "{% if is_state('switch.slaapkamer_tv', 'off') %}\n  switch.slaapkamer_tv\n{%
        else %}\n  script.turn_off_tv_slaapkamer\n{% endif %}\n"
turn_off_tv_slaapkamer:
  alias: Turn off TV Slaapkamer
  sequence:
  - service: media_player.turn_off
    entity_id: media_player.slaapkamer
  - service: light.turn_off
    entity_id: light.slaapkamer_achterwand
  - delay: 00:00:15
  - service: switch.turn_off
    entity_id: switch.slaapkamer_tv
noop:
  alias: noop
  sequence:
    delay: 00:00:00
notify_admin:
  sequence:
  - condition: state
    entity_id: input_boolean.admin_notifications
    state: 'on'
  - service: notify.pushover_admin
    data_template:
      title: Admin message
      message: '{{ message }}'
notify_alert:
  sequence:
  - service: notify.pushover
    data_template:
      title: Alert!!!
      message: '{{ message }}'
      data:
        priority: 1
